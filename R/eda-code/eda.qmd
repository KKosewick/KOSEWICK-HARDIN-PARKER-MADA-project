---
title: "Exploratory Data Analysis: Project Part 2"
author: "Kevin Kosewick & Emma Hardin-Parker"
date: "2/20/2024"
output: html_document
---

This document contains our exploratory analysis of our chosen data set, sleepdata. We intend to perform any needed cleaning and mutation to the data as well as creating exploratory plots and tables to gain a better understanding of the data. As stated in the manuscript, we are looking to determine which variables or identifiers have significant impacts on sleep quality. 

# Setup

```{r}
#Loading necessary libraries
library(here) #for data loading/saving
library(dplyr)
library(skimr)
library(ggplot2)
library(tidyverse)
```
# Getting to know the data 

Load & View the data.

```{r}
sleepdata <- read.csv(here("data","raw-data", "ss.csv"))
View(sleepdata)
```

Exploring the structure and format of the data. 

```{r}
summary(sleepdata)
structure(sleepdata)
```
The data set contains 373 observations for 13 variables. Some variables are not easily understandable at face value, so we went back to the data source and accessed the data dictionary. The variables are defined as follows:

Person ID: A unique identifier for each participant.
Gender: The participant's gender (Male/Female).
Age: The participant's age in years.
Occupation: The job or career of the participant.
Sleep Duration (hours): The daily sleep duration of the participant in hours.
Quality of Sleep (scale: 1-10): A subjective assessment of sleep quality on a scale from 1 to 10.
Physical Activity Level (minutes/day): The daily duration of physical activity for the participant, measured in minutes.
Stress Level (scale: 1-10): A subjective assessment of the participant's stress level on a scale from 1 to 10.
BMI Category: The participant's BMI classification (e.g., Underweight, Normal, Overweight).
Blood Pressure (systolic/diastolic): The participant's blood pressure, represented as systolic pressure over diastolic pressure.
Heart Rate (bpm): The participant's resting heart rate, measured in beats per minute.
Daily Steps: The number of steps the participant takes each day.
Sleep Disorder: The presence or absence of a sleep disorder in the participant (None, Insomnia, Sleep Apnea).

Before going further into the exploratory analysis, we need to determine whether missing values are present and if they could jeopardize any future analyses. 

```{r}
print(sum(is.na(sleepdata)))
```

There are no missing values in our data set! We can now move on to creating new variables or transmuting existing variables. 

# Data Transformation 

We are going to create a categorical variable to go alongside the existing blood pressure variable. We are using blood pressure guidelines from the American Heart Association to create our new categorical blood pressure variable. Our goal with this is to see how blood pressure can affect sleep quality in a more digestible way. First, we will need to create new systolic and diastolic variables to ultimately create our categorical variable. We have attached the guidelines here: 

[![AHA Guidelines](AHA_Guidelines.png)](https://www.heart.org/en/health-topics/high-blood-pressure)

```{r}
# Splitting the Blood.Pressure variable into systolic and diastolic variable columns
sleepdata <- sleepdata %>%
  separate(Blood.Pressure, into = c("systolic", "diastolic"), sep = "/")

# Ensuring that the new columns are considered numeric 
sleepdata$systolic <- as.numeric(sleepdata$systolic)
sleepdata$diastolic <- as.numeric(sleepdata$diastolic)

# Creating new categorical variable 

sleepdata <- sleepdata %>%
  mutate(cat_bp = case_when(
    systolic < 120 & diastolic < 80 ~ "Normal",
    systolic >= 120 & systolic <= 129 & diastolic < 80 ~ "Elevated",
    (systolic >= 130 & systolic <= 139) | (diastolic >= 80 & diastolic <= 89) ~ "Stage 1 Hypertension",
    systolic >= 140 | diastolic >= 90 ~ "Stage 2 Hypertension"
  ))
```

Now that we have created this new variable and adjusted the format of the blood pressure variables, we are now going to further explore the other variables to see if they are fit, as is, for analysis. We noticed that within the BMI.Category variable, there are both "Normal" and "Normal Weight" categories. We assume this was an oversight in data entry, and intend to merge the two together to ensure all "Normal" categories are together for subsequent analyses. 

```{r}
# Merging "Normal" and "Normal Weight" attributes into a singular "Normal" category

sleepdata <- sleepdata %>%
  mutate(BMI.Category = case_when(
    BMI.Category %in% c("Normal", "Normal Weight") ~ "Normal",
    BMI.Category == "Overweight" ~ "Overweight",
    BMI.Category == "Obese" ~ "Obese",
  ))
```


As of this point in our cleaning, we feel confident that the data is structured in such a way that analyses can be performed. 
